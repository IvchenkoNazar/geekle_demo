<div class="flex w-full">
  <!-- Empty space for the left half -->
  <div class="w-1/2"></div>

  <!-- Side menu on the right half -->
  <div class="w-1/2 flex flex-col h-screen p-4">
    <!-- Fixed header -->
    <div>
      <h2 class="text-xl font-bold mb-4 text-green-600">Geekle AI Demo</h2>
      <component-search class="mb-4 block" />
    </div>

    <!-- Scrollable content -->
    <div class="flex-1 overflow-y-auto">
      @if (!!menuItems()) {
        <ul class="space-y-2">
          @for (item of menuItems(); track item.name) {
            <li>
              <div
                (click)="selectMenuItem(item)"
                class="flex justify-between items-center p-2 hover:bg-gray-100 rounded transition-colors duration-200 ease-in-out cursor-pointer"
                [ngClass]="{'bg-gray-100': isItemHighlighted(item)}"
              >
                <span class="font-semibold text-gray-800">
                  {{ item.name }}
                  @if (item.isReviewed) {
                    <ng-template [ngTemplateOutlet]="approved" [ngTemplateOutletContext]="{menuItem: item}" />
                  }
                </span>
                @if (item.children) {
                  <span class="text-sm transition-transform duration-200 ease-in-out text-gray-500"
                        [ngClass]="{'transform rotate-180': item.expanded}">
                    ▼
                  </span>
                }
              </div>
              @if (item.children) {
                <ul
                  class="mt-2 ml-4 space-y-1 overflow-hidden transition-all duration-200 ease-in-out border-l-2 border-gray-200"
                  [ngClass]="{'max-h-0 border-l-0': !item.expanded, 'max-h-[1000px]': item.expanded}"
                >
                  @for (child of item.children; track child.name) {
                    <li
                      (click)="selectMenuItem(child)"
                      class="p-2 hover:bg-gray-100 transition-colors duration-200 ease-in-out cursor-pointer text-sm font-normal border-l-4"
                      [ngClass]="{
                        'bg-gray-100 border-green-600': isItemHighlighted(child),
                        'border-transparent': !isItemHighlighted(child)
                      }"
                    >
                      {{ child.name }}
                      @if (child.isReviewed) {
                        <ng-template [ngTemplateOutlet]="approved" [ngTemplateOutletContext]="{menuItem: child}" />
                      }
                    </li>
                  }
                </ul>
              }
            </li>
          }
        </ul>
      } @else {
        <div class="inline-flex items-center justify-center">
          <div class="animate-spin h-5 w-5 mr-3 border-t-2 border-b-2 border-green-600 rounded-full"></div>
          <span>Loading sections...</span>
        </div>
      }
    </div>
  </div>
</div>

<ng-template #approved let-menuItem="menuItem">
  <span class="text-green-500 ml-1"
        title="Approved by {{menuItem.reviewedBy}} on {{(menuItem.reviewedDate | date:'medium')}}">✅</span>
</ng-template>
